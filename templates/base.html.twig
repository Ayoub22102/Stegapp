<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Bienvenue!{% endblock %}</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    {% block stylesheets %}
        {{ encore_entry_link_tags('app') }}
        <style>
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
            }
            body {
                display: flex;
                flex-direction: column;
            }
            .container {
                flex: 1;
            }
            footer {
                position: sticky;
                bottom: 0;
                width: 100%;
            }
            .navbar {
                transition: top 0.3s ease-in-out;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                height: 64px; /* Navbar height */
                background-color: black; /* Set navbar background to black */
                color: white; /* Set navbar text color to white */
            }
            .flash-message-container {
                margin-top: 4rem; /* Ensure the flash messages appear below the navbar */
            }
        </style>
    {% endblock %}
</head>
<body class="flex flex-col min-h-screen">
    <!-- Navbar -->
    <nav class="navbar text-white p-4 fixed w-full z-50 top-0">
        <div class="container mx-auto flex justify-between items-center">
            <!-- Logo -->
            <a href="#" class="flex items-center space-x-2">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/Solar_Panel_Icon.svg/1024px-Solar_Panel_Icon.svg.png" alt="STEG Logo" class="h-8 w-8">
                <span class="text-lg font-bold">STEG Réclamations</span>
            </a>

            <!-- Mobile Menu Button -->
            <button class="block lg:hidden focus:outline-none" id="menu-toggle" aria-label="Menu">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>

            <!-- Links -->
            <ul class="hidden lg:flex space-x-6 items-center" id="menu">
                {% if app.user %}
                    {# Checking based on roles instead of instance #}
                    {% if is_granted('ROLE_CLIENT') %}
                        <li>
                            <a href="{{ path('app_reclamation_new') }}" class="hover:text-gray-300 flex items-center space-x-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                <span>Ajouter Réclamation</span>
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_reclamation_index') }}" class="hover:text-gray-300 flex items-center space-x-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 4H5m14-8H5m14 12H5" />
                                </svg>
                                <span>Consulter mes Réclamations</span>
                            </a>
                        </li>
                        <!-- Feedback Button for Clients -->
                        <li>
                            <a href="{{ path('feedback_list') }}" class="hover:text-gray-300 flex items-center space-x-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5v14" />
                                </svg>
                                <span>Feedback</span>
                            </a>
                        </li>
                    {% elseif is_granted('ROLE_CHEF_EQUIPE') %}
                        <li>
                            <a href="{{ path('attenteapp_attente_index') }}" class="hover:text-gray-300 flex items-center space-x-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                                </svg>
                                <span>Liste des Réclamations</span>
                            </a>
                        </li>
                        <!-- Clôturer Button for Chef d'équipe -->
                        <li>
                            <a href="{{ path('cloture_interventions') }}" class="hover:text-gray-300 flex items-center space-x-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5v14" />
                                </svg>
                                <span>Clôturer Interventions</span>
                            </a>
                        </li>
                    {% elseif is_granted('ROLE_TECHNICIEN') %}
                        <li>
                            <a href="{{ path('technicien_planning') }}" class="hover:text-gray-300 flex items-center space-x-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                                </svg>
                                <span>Planning Technicien</span>
                            </a>
                        </li>
                    {% else %}
                        <li>
                            <a href="{{ path('admin_dashboard') }}" class="hover:text-gray-300 flex items-center space-x-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                                </svg>
                                <span>Tableau de bord Admin</span>
                            </a>
                        </li>
                    {% endif %}
                    <li>
                        <a href="{{ path('app_logout') }}" class="hover:text-gray-300 flex items-center space-x-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7" />
                            </svg>
                            <span>Se Déconnecter</span>
                        </a>
                    </li>
                {% else %}
                    <li>
                        <a href="{{ path('app_login') }}" class="hover:text-gray-300 flex items-center space-x-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12h7m0 0l-3 3m3-3l-3-3m-7 3H3" />
                            </svg>
                            <span>S'authentifier</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ path('app_register_Client') }}" class="hover:text-gray-300 flex items-center space-x-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                            <span>Créer un compte</span>
                        </a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </nav>

    <!-- Flash Messages -->
    <div class="flash-message-container mt-16"> <!-- Ensure flash messages appear below navbar -->
        {% for label, messages in app.flashes %}
            <div class="container mx-auto mt-4">
                <div class="bg-{{ label == 'success' ? 'green' : (label == 'error' ? 'red' : 'yellow') }}-100 border-l-4 border-{{ label == 'success' ? 'green' : (label == 'error' ? 'red' : 'yellow') }}-500 text-{{ label == 'success' ? 'green' : (label == 'error' ? 'red' : 'yellow') }}-700 p-4 rounded-md">
                    {% for message in messages %}
                        <p>{{ message }}</p>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>

    <!-- Main Content -->
    <div class="container mx-auto p-4 flex-grow">
        {% block body %}{% endblock %}
    </div>

    <!-- Footer -->
    <footer class="bg-gray-100 text-center py-3 mt-4">
        <p>&copy; {{ "now"|date("Y") }} STEG Réclamations. Tous droits réservés.</p>
    </footer>

    {% block javascripts %}
        {{ encore_entry_script_tags('app') }}
        <script>
            const menuToggle = document.getElementById('menu-toggle');
            const menu = document.getElementById('menu');

            menuToggle.addEventListener('click', () => {
                menu.classList.toggle('hidden');
            });

            let prevScrollpos = window.pageYOffset;
            window.onscroll = function() {
                let currentScrollPos = window.pageYOffset;
                const navbar = document.querySelector('.navbar');

                if (prevScrollpos > currentScrollPos) {
                    navbar.style.top = "0";
                } else {
                    navbar.style.top = "-60px";
                }
                prevScrollpos = currentScrollPos;
            }
        </script>
    {% endblock %}
</body>
</html>
